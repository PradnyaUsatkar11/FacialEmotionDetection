{"ast":null,"code":"import _taggedTemplateLiteral from \"/Users/omkar/Documents/Pradnya/bits_project/FacialEmotionDetection/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/omkar/Documents/Pradnya/bits_project/FacialEmotionDetection/src/App.js\";\n\nfunction _templateObject8() {\n  const data = _taggedTemplateLiteral([\"\\n    position: relative;\\n    width: 90px;\\n    height: 90px;\\n    border-radius: 50%;\\n    background-color: red;\\n    bottom: 8%;\\n    z-index: 10;\\n  \"]);\n\n  _templateObject8 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  const data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    display: flex;\\n    justify-content: center;\\n    width: 100%;\\n    bottom: 20px;\\n  \"]);\n\n  _templateObject7 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  const data = _taggedTemplateLiteral([\"\\n    width: 100%;\\n    height: 100%;\\n    background-image: url(\\\"\", \"\\\");\\n    background-position: center;\\n    background-size: cover;\\n  \"]);\n\n  _templateObject6 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  const data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    width: 100%;\\n    height: 100%;\\n    display: flex;\\n    justify-content: center;\\n    align-items: center;\\n\\n    & > span {\\n      color: white;\\n      font-size: 72px;\\n    }\\n  \"]);\n\n  _templateObject5 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  const data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    width: 120px;\\n    height: 120px;\\n    border-radius: 50%;\\n    background-color: #f8e71c;\\n    display: flex;\\n    justify-content: center;\\n    align-items: center;\\n    z-index: 10;\\n    & > p {\\n      font-size: 14px;\\n      text-align: center;\\n      line-height: 1.3em;\\n    }\\n  \"]);\n\n  _templateObject4 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  const data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    top: calc(\", \" - 3px);\\n    left: calc(\", \" - 3px);\\n    width:  calc(100% - \", \" * 2 - 4px);\\n    height: calc(100% - \", \" * 2 - 4px);\\n    border: 6px solid #ddd8e6;\\n    border-radius: 10px\\n    box-shadow: 0px 0px 0px 9999px rgba(0,0,0,0.5);\\n\\n  \"]);\n\n  _templateObject3 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n    position: absolute;\\n    min-width: 100%;\\n    min-height: 100%;\\n    object-fit: cover;\\n    object-position: 50% 50%;\\n  \"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n    position: relative;\\n    width: 100vw;\\n    height: 100vh;\\n  \"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Webcam from \"react-webcam\";\nimport styled from 'styled-components';\nimport './style.css';\nimport { Rectangle } from 'draw-shape-reactjs';\nconst camera = \"environment\";\n\nconst request = require('request-promise');\n\nconst width = \"15%\";\nconst height = \"10%\";\nconst Styled = {\n  Root: styled.div(_templateObject()),\n  Webcam: styled(Webcam)(_templateObject2()),\n  Border: styled.div(_templateObject3(), () => height, () => width, () => width, () => height),\n  Comments: styled.div(_templateObject4()),\n  Countdown: styled.div(_templateObject5()),\n  Confirm: styled.div(_templateObject6(), ({\n    file\n  }) => file),\n  Center: styled.div(_templateObject7()),\n  Button: styled.div(_templateObject8())\n};\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.renderWebcam = () => React.createElement(Styled.Webcam, {\n      audio: false,\n      screenshotWidth: 1080,\n      videoConstraints: {\n        facingMode: camera,\n        width: 1920,\n        height: 1080\n      },\n      ref: this.webcam,\n      screenshotFormat: \"image/jpeg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    });\n\n    this.renderWaitingShot = () => React.createElement(React.Fragment, null, this.renderWebcam(), React.createElement(Styled.Center, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(Styled.Button, {\n      onClick: this.handleTakePhoto,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    })));\n\n    this.renderCountdown = () => React.createElement(React.Fragment, null, this.renderWebcam(), React.createElement(Styled.Countdown, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, this.state.countdown)));\n\n    this.renderMultipleFace = response => this.setState({\n      faces: response.map(i => {\n        return React.createElement(\"li\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(Styled.Comments, {\n          style: {\n            top: 25 + \"%\",\n            left: 7 + \"%\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, response[i].emotion)));\n      })\n    });\n\n    this.renderConfirmScreen = (emotion, i) => React.createElement(Styled.Confirm, {\n      file: this.state.outputImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    });\n\n    this.handleTakePhoto = async () => {\n      this.timer = setInterval(() => {\n        if (this.state.countdown === 1) {\n          new Promise(async (resolve, reject) => {\n            this.setState({\n              file: this.webcam.current.getScreenshot()\n            }); //    let newImage=this.state.file.replace(/^data:image\\/[a-z]+;base64,/, \"\");\n\n            var options = {\n              'method': 'POST',\n              'url': 'http://34.93.216.143:8080/api/image/',\n              'headers': {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                \"image\": this.state.file\n              })\n            };\n\n            try {\n              let response = await request(options);\n              console.log(\"code..\", typeof response);\n\n              if (response) {\n                response = JSON.parse(response);\n                console.log(\"response.body[success][0].emotion\", response[\"success\"]);\n\n                if (response[\"message\"] == \"success\") {\n                  this.setState({\n                    \"outputImage\": response[\"image\"]\n                  }); // for (let i = 0; i < response[\"success\"].length; i++) {\n                  //   console.log(\"response.body[success][0].emotion\", response[\"success\"][0].emotion)\n                  //   this.setState({ emotion: response[\"success\"][i].emotion })\n                  //   this.renderMultipleFace(i)\n                  //   this.updateCanvas()\n                  // }\n                } else {\n                  this.setState({\n                    emotion: \"No face\"\n                  });\n                }\n              } else {\n                console.log(\"Some error occurred\");\n              }\n\n              resolve();\n            } catch (error) {\n              console.log(\"error in api call...\");\n              reject();\n            }\n          });\n        }\n\n        if (this.state.countdown > 1) {\n          this.setState({\n            countdown: this.state.countdown - 1\n          });\n        } else {\n          clearInterval(this.timer);\n          this.setState({\n            viewState: 2\n          });\n        }\n      }, 1000);\n      this.setState({\n        viewState: 1,\n        countdown: 3\n      });\n    };\n\n    this.handleReTakePhoto = () => {};\n\n    this.rect = values => {\n      const ctx = values.ctx,\n            x = values.x,\n            y = values.y,\n            width = values.width,\n            height = values.height;\n      ctx.fillRect(x, y, width, height);\n    };\n\n    this.updateCanvas = () => {\n      const ctx = this.refs.canvas.getContext('2d');\n      ctx.clearRect(0, 0, 300, 300); // draw children “components”\n\n      this.rect({\n        ctx,\n        x: 10,\n        y: 10,\n        width: 50,\n        height: 50\n      });\n      this.rect({\n        ctx,\n        x: 110,\n        y: 110,\n        width: 50,\n        height: 50\n      });\n    };\n\n    this.renderMainView = () => {\n      switch (this.state.viewState) {\n        case 0:\n          return this.renderWaitingShot();\n\n        case 1:\n          return this.renderCountdown();\n\n        case 2:\n          {\n            return this.renderConfirmScreen();\n          }\n      }\n    };\n\n    this.webcam = React.createRef();\n    this.state = {\n      viewState: 0,\n      countdown: 3,\n      emotion: undefined,\n      file: undefined,\n      outputImage: undefined // faces: [],\n      // Angry: undefined,\n      // Disgusted: undefined,\n      // Happy: undefined,\n      // Sad: undefined,\n      // Neutral: undefined,\n      // Fearful: undefined,\n      // Surprised: undefined,\n      // rectangle: undefined,\n\n    };\n  }\n\n  render() {\n    return React.createElement(Styled.Root, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254\n      },\n      __self: this\n    }, this.renderMainView(), React.createElement(\"canvas\", {\n      ref: \"canvas\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    }), React.createElement(Styled.Border, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/omkar/Documents/Pradnya/bits_project/FacialEmotionDetection/src/App.js"],"names":["React","Component","render","Webcam","styled","Rectangle","camera","request","require","width","height","Styled","Root","div","Border","Comments","Countdown","Confirm","file","Center","Button","App","constructor","props","renderWebcam","facingMode","webcam","renderWaitingShot","handleTakePhoto","renderCountdown","state","countdown","renderMultipleFace","response","setState","faces","map","i","top","left","emotion","renderConfirmScreen","outputImage","timer","setInterval","Promise","resolve","reject","current","getScreenshot","options","body","JSON","stringify","console","log","parse","error","clearInterval","viewState","handleReTakePhoto","rect","values","ctx","x","y","fillRect","updateCanvas","refs","canvas","getContext","clearRect","renderMainView","createRef","undefined"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { render } from 'react-dom';\nimport Webcam from \"react-webcam\";\nimport styled from 'styled-components';\nimport './style.css';\nimport {\n  Rectangle\n} from 'draw-shape-reactjs';\nconst camera = \"environment\";\nconst request = require('request-promise');\n\n\nconst width = \"15%\";\nconst height = \"10%\";\n\nconst Styled = {\n  Root: styled.div`\n    position: relative;\n    width: 100vw;\n    height: 100vh;\n  `,\n  Webcam: styled(Webcam)`\n    position: absolute;\n    min-width: 100%;\n    min-height: 100%;\n    object-fit: cover;\n    object-position: 50% 50%;\n  `,\n  Border: styled.div`\n    position: absolute;\n    top: calc(${() => height} - 3px);\n    left: calc(${() => width} - 3px);\n    width:  calc(100% - ${() => width} * 2 - 4px);\n    height: calc(100% - ${() => height} * 2 - 4px);\n    border: 6px solid #ddd8e6;\n    border-radius: 10px\n    box-shadow: 0px 0px 0px 9999px rgba(0,0,0,0.5);\n\n  `,\n  Comments: styled.div`\n    position: absolute;\n    width: 120px;\n    height: 120px;\n    border-radius: 50%;\n    background-color: #f8e71c;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 10;\n    & > p {\n      font-size: 14px;\n      text-align: center;\n      line-height: 1.3em;\n    }\n  `,\n  Countdown: styled.div`\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    & > span {\n      color: white;\n      font-size: 72px;\n    }\n  `,\n  Confirm: styled.div`\n    width: 100%;\n    height: 100%;\n    background-image: url(\"${({ file }) => file}\");\n    background-position: center;\n    background-size: cover;\n  `,\n  \n  Center: styled.div`\n    position: absolute;\n    display: flex;\n    justify-content: center;\n    width: 100%;\n    bottom: 20px;\n  `,\n  Button: styled.div`\n    position: relative;\n    width: 90px;\n    height: 90px;\n    border-radius: 50%;\n    background-color: red;\n    bottom: 8%;\n    z-index: 10;\n  `,\n}\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.webcam = React.createRef();\n    this.state = {\n      viewState: 0,\n      countdown: 3,\n      emotion: undefined,\n      file: undefined,\n      outputImage:undefined,\n      // faces: [],\n      // Angry: undefined,\n      // Disgusted: undefined,\n      // Happy: undefined,\n      // Sad: undefined,\n      // Neutral: undefined,\n      // Fearful: undefined,\n      // Surprised: undefined,\n      // rectangle: undefined,\n      \n    };\n  }\n\n  renderWebcam = () => (\n    <Styled.Webcam audio={false} screenshotWidth={1080} videoConstraints={{ facingMode: camera, width: 1920, height: 1080 }} ref={this.webcam} screenshotFormat=\"image/jpeg\" />\n  )\n\n  renderWaitingShot = () => (\n    <>\n      {this.renderWebcam()}\n      <Styled.Center>\n        <Styled.Button onClick={this.handleTakePhoto} />\n      </Styled.Center>\n    </>\n  )\n\n  renderCountdown = () => (\n    <>\n      {this.renderWebcam()}\n      <Styled.Countdown>\n        <span>{this.state.countdown}</span>\n      </Styled.Countdown>\n    </>\n  )\n\n\n  renderMultipleFace = (response) => (\n\n    this.setState({\n      faces: response.map((i) => {\n        return (<li><Styled.Comments style={{ top: 25 + \"%\", left: 7 + \"%\" }}>\n          <p>{response[i].emotion}</p>\n        </Styled.Comments></li>\n        )\n      })\n    })\n\n  )\n\n  renderConfirmScreen = (emotion, i) => (\n    <Styled.Confirm file={this.state.outputImage}>\n     {/* <Styled.Comments style={{ top: \"100px\", left: \"50px\" }}>\n          <p>Happy {this.state.Happy}</p>\n        </Styled.Comments>\n        <Styled.Comments style={{ top: \"25%\", left: \"7%\" }}>\n          <p>Sad {this.state.Sad}</p>\n        </Styled.Comments> */}\n    </Styled.Confirm>\n\n  )\n\n  handleTakePhoto = async () => {\n    this.timer = setInterval(() => {\n      if (this.state.countdown === 1) {\n        new Promise(async (resolve, reject) => {\n          this.setState({ file: this.webcam.current.getScreenshot() });\n          //    let newImage=this.state.file.replace(/^data:image\\/[a-z]+;base64,/, \"\");\n          var options = {\n            'method': 'POST',\n            'url': 'http://34.93.216.143:8080/api/image/',\n            'headers': {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({ \"image\": this.state.file })\n\n          };\n          try {\n            let response = await request(options);\n            console.log(\"code..\", typeof response)\n            if (response) {\n              response = JSON.parse(response)\n              console.log(\"response.body[success][0].emotion\", response[\"success\"])\n              if (response[\"message\"]==\"success\") {\n                this.setState({\"outputImage\":response[\"image\"]})\n                // for (let i = 0; i < response[\"success\"].length; i++) {\n                //   console.log(\"response.body[success][0].emotion\", response[\"success\"][0].emotion)\n                //   this.setState({ emotion: response[\"success\"][i].emotion })\n                //   this.renderMultipleFace(i)\n                //   this.updateCanvas()\n                // }\n              }\n              else {\n                this.setState({ emotion: \"No face\" })\n              }\n            }\n            else {\n              console.log(\"Some error occurred\")\n            }\n            resolve();\n          }\n          catch (error) {\n            console.log(\"error in api call...\")\n            reject();\n          }\n        })\n      }\n      if (this.state.countdown > 1) {\n        this.setState({ countdown: this.state.countdown - 1 });\n      } else {\n        clearInterval(this.timer);\n        this.setState({ viewState: 2 });\n      }\n    }, 1000);\n\n    this.setState({ viewState: 1, countdown: 3 });\n  }\n\n  handleReTakePhoto = () => {\n\n  }\n\n  rect = (values) => {\n    const { ctx, x, y, width, height } = values;\n    ctx.fillRect(x, y, width, height);\n  }\n\n  updateCanvas = () => {\n    const ctx = this.refs.canvas.getContext('2d');\n    ctx.clearRect(0, 0, 300, 300);\n    // draw children “components”\n    this.rect({ ctx, x: 10, y: 10, width: 50, height: 50 });\n    this.rect({ ctx, x: 110, y: 110, width: 50, height: 50 });\n  }\n\n  renderMainView = () => {\n    switch (this.state.viewState) {\n      case 0:\n        return this.renderWaitingShot();\n      case 1:\n        return this.renderCountdown();\n      case 2:\n        {\n          return this.renderConfirmScreen();\n        }\n    }\n  }\n\n  render() {\n    return (\n      <Styled.Root>\n        {this.renderMainView()}\n        <canvas ref=\"canvas\" />\n        <Styled.Border />\n      </Styled.Root>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}